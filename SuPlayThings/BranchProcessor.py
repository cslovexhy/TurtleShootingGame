# this is copyed from: https://anvil.amazon.com/risks/374115

data = """
Branch: sas-lol
https://code.amazon.com/packages/DadetAviaryService/blobs/f1b9479edd3ecfa028400c4fd61b4cc4914191c4/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=761

Branch: frhackremoval
https://code.amazon.com/packages/DadetAviaryService/blobs/3d58eb925c3b8028b029a2b7720e7d030fda1206/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: JarvisFixTesting
https://code.amazon.com/packages/DadetAviaryService/blobs/57a6f64298dec799ca9bcf3400d9ac641debc17c/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: QAChannel
https://code.amazon.com/packages/DadetAviaryService/blobs/71b89875434f2a8278655f9a70b468e5ee4fdc37/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: frhackmetric
https://code.amazon.com/packages/DadetAviaryService/blobs/3e70f23806e51e7641242ead9e3850d833238f83/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=792

Branch: JarvisFix
https://code.amazon.com/packages/DadetAviaryService/blobs/43ccee67440d549163d032394a6fef96ba6f5c5d/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832

Branch: PrithvisJarvisBranch
https://code.amazon.com/packages/DadetAviaryService/blobs/563aa5f9bae9083f725206314746388e242f32ab/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832

Branch: frhackmetric
https://code.amazon.com/packages/DadetAviaryService/blobs/3e70f23806e51e7641242ead9e3850d833238f83/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: siva-backup
https://code.amazon.com/packages/DadetAviaryService/blobs/5448703f5029f5ba086ebb5973ebe9525beba5f2/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: revertedCommit
https://code.amazon.com/packages/DadetAviaryService/blobs/0bc99b96455ed8a2338262178a5ecb0d22ef7fca/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: fixdna
https://code.amazon.com/packages/DadetAviaryService/blobs/2fe6d2ac7ef18584bbe56b401b16bd5f6bc19f6e/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832

Branch: QAChannel
https://code.amazon.com/packages/DadetAviaryService/blobs/71b89875434f2a8278655f9a70b468e5ee4fdc37/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=796

Branch: fixJarvisEnablement
https://code.amazon.com/packages/DadetAviaryService/blobs/bb8ecfca07dc5d35fc26b94a35d8731e6f4a4de2/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: JarvisFix
https://code.amazon.com/packages/DadetAviaryService/blobs/43ccee67440d549163d032394a6fef96ba6f5c5d/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: revertedCommit
https://code.amazon.com/packages/DadetAviaryService/blobs/0bc99b96455ed8a2338262178a5ecb0d22ef7fca/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832

Branch: sas-lol
https://code.amazon.com/packages/DadetAviaryService/blobs/f1b9479edd3ecfa028400c4fd61b4cc4914191c4/--/static-content/sso/fullPreview.js?hl_lines=605

Branch: FireTVAds-3056
https://code.amazon.com/packages/DadetAviaryService/blobs/7749be047bbb32384d1f6b8fbc24acd6db6fd0b8/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832

Branch: fixJarvisEnablement
https://code.amazon.com/packages/DadetAviaryService/blobs/bb8ecfca07dc5d35fc26b94a35d8731e6f4a4de2/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832

Branch: fixdna
https://code.amazon.com/packages/DadetAviaryService/blobs/2fe6d2ac7ef18584bbe56b401b16bd5f6bc19f6e/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: JarvisFixTesting
https://code.amazon.com/packages/DadetAviaryService/blobs/57a6f64298dec799ca9bcf3400d9ac641debc17c/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832

Branch: QAChannel-test
https://code.amazon.com/packages/DadetAviaryService/blobs/6397c323ff5e7bc48a9b08416eda23bd1d51e645/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: QAChannel-test
https://code.amazon.com/packages/DadetAviaryService/blobs/6397c323ff5e7bc48a9b08416eda23bd1d51e645/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=796

Branch: FireTVAds-3056
https://code.amazon.com/packages/DadetAviaryService/blobs/7749be047bbb32384d1f6b8fbc24acd6db6fd0b8/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: siva-backup
https://code.amazon.com/packages/DadetAviaryService/blobs/5448703f5029f5ba086ebb5973ebe9525beba5f2/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832

Branch: PrithvisJarvisBranch
https://code.amazon.com/packages/DadetAviaryService/blobs/563aa5f9bae9083f725206314746388e242f32ab/--/static-content/sso/fullPreview.js?hl_lines=724

Branch: frhackremoval
https://code.amazon.com/packages/DadetAviaryService/blobs/3d58eb925c3b8028b029a2b7720e7d030fda1206/--/static-content/sso/rodeoPushToFireTVPreview.js?hl_lines=832
"""

# this is get by using:
# git for-each-ref --format='%(committerdate) %09 %(authorname) %09 %(refname)' --sort=committerdate

branch_owner_list = [
    ["Cassie Sun", "remotes/origin/caizhibi/dev/mini-detail-video-preview"],
    ["Zhibin Cai", "remotes/origin/dev/preview"],
    ["Siddhesh Shirsat", "remotes/origin/DNA-Aviary-Merge"],
    ["usaxena", "remotes/origin/LiveTabPreview"],
    ["Lorenzo Campanella", "remotes/origin/screensaver-push-to-device"],
    ["Lorenzo Campanella", "remotes/origin/mainline-backup-with-qa"],
    ["Shirsat", "remotes/origin/WCAP-PreviewAds"],
    ["Eric Chen", "remotes/origin/livetab_erchen"],
    ["Gautham Shriyan", "remotes/origin/shriyag/scry-ui"],
    ["Gautham Shriyan", "remotes/origin/scry-ui-1"],
    ["Siddhesh Shirsat", "remotes/origin/RowIdRowText"],
    ["Siddhesh Shirsat", "remotes/origin/CoralServiceRedirect"],
    ["Sophie Huang", "remotes/origin/pirouette-expansion"],
    ["Prithvi Kumar", "remotes/origin/test"],
    ["Siddhesh Shirsat", "remotes/origin/AviaryAsFederatedService"],
    ["Jonathan Tan", "remotes/origin/supply-standardization"],
    ["bruche", "remotes/origin/testAllAds"],
    ["Sophie Huang", "remotes/origin/pirouette-additional-tiles"],
    ["Yuyang Zhao", "remotes/origin/debug/yuyang"],
    ["bruche", "remotes/origin/testingDirectedId"],
    ["Umang Saxena", "remotes/origin/frhack"],
    ["Daniel Kim", "remotes/origin/DXP-1412"],
    ["Sumanth Sathyanarayana", "remotes/origin/meltingPot"],
    ["bruche", "remotes/origin/weblabTest"],
    ["bruche", "remotes/origin/weblabTest2"],
    ["bruche", "remotes/origin/weblabPlacement"],
    ["bruche", "remotes/origin/weblabFrTest"],
    ["bruche", "remotes/origin/weblabWcapTest"],
    ["Umang Saxena", "remotes/origin/frhackmetric"],
    ["Siva Renganathan", "remotes/origin/pcon-gamma-test"],
    ["Sasanka", "remotes/origin/sas-lol"],
    ["Prithvi", "remotes/origin/prithvitry"],
    ["Prithvi", "remotes/origin/tryanother"],
    ["Prithvi Kumar", "remotes/origin/PrithvisJarvisBranch"],
    ["Sasanka", "remotes/origin/revertedCommit"],
    ["Umang Saxena", "remotes/origin/fixdna"],
    ["Siva Renganathan", "remotes/origin/FireTVAds-3056"],
    ["Siva Renganathan", "remotes/origin/siva-backup"],
    ["Sasanka", "remotes/origin/sas-pmetrics"],
    ["Siva Renganathan", "heads/pcon-fix"],
    ["Siva Renganathan", "remotes/origin/pcon-fix"],
    ["Prithvi Kumar", "remotes/origin/fixJarvisEnablement"],
    ["Prithvi Kumar", "remotes/origin/JarvisFix"],
    ["Prithvi Kumar", "remotes/origin/JarvisFixTesting"],
    ["Cyrus Morshedi", "heads/mainline"],
    ["Cyrus Morshedi", "remotes/origin/HEAD"],
    ["Cyrus Morshedi", "remotes/origin/mainline"],
]


def process():
    risky_branch_to_links_map = dict()
    data_rows = [row for row in data.split("\n") if row]
    for i in range(0, int(len(data_rows)/2), 2):
        branch, link = data_rows[i][8:], data_rows[i+1]
        if branch not in risky_branch_to_links_map:
            risky_branch_to_links_map[branch] = []
        risky_branch_to_links_map[branch].append(link)

    for branch, links in risky_branch_to_links_map.items():
        print(branch)
        for link in links:
            print("     " + link)
        print("")

    branch_owner_map = dict()
    owner_branch_map = dict()
    for row in branch_owner_list:
        owner, branch, raw_branch = row[0], row[1].split("/")[-1], row[1]
        branch_owner_map[branch] = owner
        if owner not in owner_branch_map:
            owner_branch_map[owner] = []
        owner_branch_map[owner].append(raw_branch)

    for branch, owner in branch_owner_map.items():
        print("{} -> {}".format(branch, owner))

    print("")
    print("")
    print("")
    print("All branches, (*) means branch has Anvil Risk, need merge from mainline.")
    print("")
    bad_owners = dict()
    for owner, raw_branches in owner_branch_map.items():
        print(owner)
        for raw_branch in raw_branches:
            branch = raw_branch.split("/")[-1]
            raw_branch_str = "       " + raw_branch
            if branch in risky_branch_to_links_map:
                raw_branch_str += " (*)"
                if owner not in bad_owners:
                    bad_owners[owner] = []
                bad_owners[owner].append(raw_branch)
            print(raw_branch_str)

    print("")
    print("")
    print("Owners need actions before 9/18/2020 are:")
    print("")
    for owner, raw_branches in bad_owners.items():
        print(owner)
        for raw_branch in raw_branches:
            print("      " + raw_branch)


process()